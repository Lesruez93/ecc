{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts"],"names":[],"mappings":"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","file":"24.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {IonicPageModule} from 'ionic-angular';\nimport {LoginPage} from './login';\n\n@NgModule({\n  declarations: [\n    LoginPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginPage),\n  ],\n})\nexport class LoginPageModule {\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import {Component} from '@angular/core';\r\nimport {Alert, AlertController, IonicPage, LoadingController, NavController, NavParams, Platform} from 'ionic-angular';\r\n\r\nimport {Firebase} from '@ionic-native/firebase';\r\nimport {AngularFireAuth} from 'angularfire2/auth';\r\nimport {HttpClient} from \"@angular/common/http\";\r\nimport {Storage} from \"@ionic/storage\";\r\nimport {Api} from \"../../providers\";\r\nimport {MembersProf} from \"../../providers/memberProf/members-prof\";\r\nimport * as firebase from \"firebase\";\r\nimport {FunctionsProvider} from \"../../providers/functions/functions\";\r\n\r\n\r\n@IonicPage({\r\n  name: \"login\"\r\n})\r\n\r\n@Component({\r\n  selector: 'page-login',\r\n  templateUrl: 'login.html',\r\n})\r\nexport class LoginPage {\r\n  verificationId = ''\r\n  code = '';\r\n  private uid: any ;\r\n  showCodeInput = false;\r\n    private isDisabled: boolean=false;\r\n\r\n  private user: any;\r\n  private phoneNumber: any;\r\n    private phone: string;\r\n    private userinfo: any = {};\r\n    private logged: any;\r\n\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams,\r\n              private FireBase: Firebase,\r\n              private  alertCtrl: AlertController,\r\n              private platform: Platform,\r\n              private afs: AngularFireAuth,\r\n              private http: HttpClient,\r\n              private  storage: Storage,\r\n              private  api: Api,\r\n              private  func: FunctionsProvider,\r\n              private loading:LoadingController,\r\n              private userr: MembersProf,\r\n  ) {\r\n      this.ViewDidLoad()\r\n\r\n  }\r\n\r\n   ViewDidLoad() {\r\n       const loader = this.loading.create({\r\n           content: \"Initializing\",\r\n           duration: 10000\r\n       });\r\n       loader.present()\r\n       this.storage.get('login').then((val) => {\r\n           this.logged = val\r\n\r\n\r\n           this.afs.authState.subscribe(res => {\r\n\r\n               if (res && res.uid && this.logged == res.uid+\"true\") {\r\n                   this.uid = res.uid;\r\n\r\n                   loader.dismissAll()\r\n\r\n                   //this.uid = navParams.get('uid') || res.uid;\r\n                   //this.bid  = navParams.get('bid')|| '1';\r\n\r\n                   this.navCtrl.setRoot('HomePage',{\r\n                    //   refresh:\"true\",\r\n                   });\r\n\r\n\r\n               }else {\r\n                   loader.dismissAll()\r\n               }\r\n\r\n\r\n\r\n           })\r\n       });\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n    async PhoneLoginNative() {\r\n\r\n    if (this.phoneNumber){\r\n        const loader = this.loading.create({\r\n        content: \"Sending code\",\r\n        duration: 10000\r\n    });\r\n        loader.present()\r\n        this.phone = \"+\"+this.phoneNumber\r\n       this.FireBase.verifyPhoneNumber(this.phone, 60)\r\n\r\n      .then((credential) => {\r\n        this.verificationId = credential.verificationId;\r\n       // console.log( \"code\" + this.verificationId)\r\n          loader.dismissAll()\r\n          this.isDisabled = true\r\n\r\n\r\n        this.showCodeInput = true;\r\n      }).catch((error) => {\r\n      this.presentAlert(error+\"failed\")\r\n        loader.dismissAll()\r\n      console.error(error)\r\n    });\r\n  }\r\n  else this.presentAlert(\"Phone Number Cannot Be Null\")\r\n  }\r\n\r\n\r\n\r\n   async verify() {\r\n       if (this.code){\r\n\r\n\r\n       const loader = this.loading.create({\r\n            content: \"Verifying\",\r\n           duration: 10000\r\n\r\n       });\r\n        loader.present()\r\n        let signInCredential =  await firebase.auth.PhoneAuthProvider.credential(this.verificationId,this.code)//\r\n\r\n        this.afs.auth.signInAndRetrieveDataWithCredential(signInCredential).then((success)=>{\r\n            console.log(\"iddd\" + success.user.uid);\r\n            loader.dismissAll()\r\n           this.loadData(success.user.uid)\r\n        }).then().catch(er =>{\r\n            this.presentAlert(\"Your device does'not support this feature\")\r\n            loader.dismissAll()\r\n            }\r\n\r\n        )}\r\n\r\n       else {\r\n          this.presentAlert(\"Please enter a valid code\")\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n  presentAlert(id) {\r\n    let alert: Alert = this.alertCtrl.create({\r\n    title: id,\r\n\r\n    buttons: ['Dismiss'],\r\n\r\n});\r\n    alert.present();\r\n  }\r\n\r\n\r\n    alertResend() {\r\n        let alertt: Alert = this.alertCtrl.create({\r\n            title: 'Resend Code',\r\n\r\n            buttons: [{\r\n                text: 'Cancel',\r\n                role: 'cancel',\r\n\r\n            },\r\n                {\r\n                    text:'Okay',handler: data =>{\r\n                        this.PhoneLoginNative()\r\n\r\n        }\r\n                }],\r\n\r\n        });\r\n        alertt.present();\r\n    }\r\n\r\n\r\n\r\n\r\n    goToBranch(){\r\n        this.afs.authState.subscribe(res => {\r\n\r\n            if (res && res.uid ) {\r\n\r\n                this.navCtrl.push('Branch', {\r\n                    uid: res.uid,\r\n                    phone: this.phone\r\n                })\r\n            }\r\n    })\r\n\r\n\r\n  }\r\n   goToLogin(){\r\n\r\n      this.navCtrl.setRoot('HomePage',{\r\n          uid:this.uid,\r\n      },{\r\n          direction: 'forward',\r\n          animate: true\r\n      });\r\n\r\n  }\r\n\r\n  resendCode(){\r\n      this.alertResend()\r\n  }\r\n  reEnter(){\r\n      this.navCtrl.setRoot(this.navCtrl.getActive().component);\r\n\r\n  }\r\nemail() {\r\n    // let credentials = {\r\n    //     email: 'lesterrrusike@gmaila.com',\r\n    //     password: 'llllllll'\r\n    // };\r\nthis.afs.auth.signInAndRetrieveDataWithEmailAndPassword('lesterrusike@gmail.com','llllllll')\r\n    .then((success)=>{\r\n        console.log(\"iddiiid\" + success.user.uid);\r\n        this.loadData(success.user.uid)\r\n    }).then().catch(er =>{\r\n        this.presentAlert(\"Something went wrong\")\r\n    }\r\n\r\n)}\r\n\r\n\r\n\r\n    private loadData(uuid) {\r\n        this.userr.qiri(uuid).then((res: any) => {\r\n            this.userinfo = JSON.parse(res.data);\r\n\r\n            console.log(this.userinfo.uid);\r\n\r\n\r\n            if (this.userinfo.uid == uuid) {\r\n                this.storage.set('login', 'true');\r\n                this.goToLogin()\r\n\r\n\r\n            }\r\n            else if (this.userinfo.uid == 'false'){\r\n                this.goToBranch()\r\n\r\n\r\n            }\r\n            else {\r\n                this.presentAlert(\"There was a problem please try again later!\")\r\n            }\r\n\r\n        }).catch(err => {\r\n            this.presentAlert(\"There was a problem please try again later!\")\r\n\r\n            console.log('ERROR: ' + JSON.stringify(err))\r\n\r\n        })\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}